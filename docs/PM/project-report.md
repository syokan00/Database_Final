# プロジェクト報告書

## 1. 背景・目的

### 1.1 背景
大学生活において、新入生や下級生は、研究室選び、就活、キャンパスライフなどに関する情報を必要としています。しかし、公式の情報源だけでは、リアルな体験談や実用的な情報を得ることが難しい場合があります。また、学生同士が中古品を売買する場も限られています。

### 1.2 目的
本プロジェクトでは、大学生向けのキャンパスライフ支援プラットフォーム「MemoLucky」を開発しました。このプラットフォームは、以下の目的を達成することを目指しています：

1. **経験談の共有**: 先輩たちのリアルな経験談や情報を共有し、後輩の意思決定を支援する
2. **フリマ機能**: 学生同士が中古品を売買できる場を提供する
3. **コミュニティ形成**: 学生同士が助け合えるコミュニティを構築する
4. **情報の可視化**: 研究室情報、就活情報などを一元的に管理・閲覧できる

### 1.3 スローガン
**"Lucky for you — あなたに届く、誰かの経験。"**

## 2. 要件定義

### 2.1 機能要件

#### 2.1.1 ユーザー管理
- ユーザー登録（メールアドレス、パスワード）
- ログイン/ログアウト（JWT 認証）
- プロフィール管理

#### 2.1.2 経験談機能
- 経験談の投稿（タイトル、本文、タグ、カテゴリ）
- 経験談の一覧表示
- 経験談の検索・フィルタリング
- いいね機能

#### 2.1.3 フリマ機能
- アイテムの出品（タイトル、説明、価格、画像、カテゴリ）
- アイテムの一覧表示
- アイテムの編集・削除
- アイテムの検索・フィルタリング

#### 2.1.4 その他の機能
- 研究室情報の閲覧
- 就活情報の閲覧
- バッジシステム
- チャット機能（開発中）

### 2.2 非機能要件

#### 2.2.1 パフォーマンス
- ページ読み込み時間: 2 秒以内
- API レスポンス時間: 1 秒以内（95 パーセンタイル）

#### 2.2.2 セキュリティ
- パスワードのハッシュ化（Argon2）
- JWT トークンベースの認証
- CORS 設定
- レート制限

#### 2.2.3 可用性
- アップタイム: 95% 以上
- ダウンタイム: 月間 36 時間以内

#### 2.2.4 拡張性
- 水平スケーリング対応
- モジュール化された設計

## 3. アーキテクチャ概要

### 3.1 システム構成
本システムは、以下の 3 層アーキテクチャで構成されています：

1. **フロントエンド層**: React + Vite（GitHub Pages にデプロイ）
2. **バックエンド層**: FastAPI（RESTful API）
3. **データ層**: PostgreSQL（リレーショナルデータベース）、MinIO（オブジェクトストレージ）、Redis（キャッシュ）

### 3.2 技術スタック

#### フロントエンド
- **React**: UI コンポーネントライブラリ
- **Vite**: 高速ビルドツール
- **React Router**: クライアントサイドルーティング（HashRouter）
- **Axios**: HTTP クライアント
- **Context API**: 状態管理

#### バックエンド
- **FastAPI**: Python Web フレームワーク
- **PostgreSQL**: リレーショナルデータベース
- **SQLAlchemy**: ORM
- **MinIO**: オブジェクトストレージ
- **Redis**: キャッシュ・レート制限
- **JWT**: 認証トークン
- **Argon2**: パスワードハッシュ

#### インフラ
- **Docker**: コンテナ化
- **Docker Compose**: マルチコンテナ管理
- **GitHub Pages**: フロントエンドの静的ホスティング
- **GitHub Actions**: CI/CD

### 3.3 データベース設計
主要なテーブル:
- `users`: ユーザー情報
- `posts`: 経験談投稿
- `items`: 出品アイテム
- `likes`: いいね情報

詳細は `docs/DBA/er-diagram.md` を参照してください。

## 4. 実装内容

### 4.1 フロントエンド実装

#### 4.1.1 ページ構成
- **ホーム画面**: アプリの紹介と新着・人気投稿の表示
- **経験談一覧画面**: すべての経験談投稿を一覧表示
- **フリマ一覧画面**: 出品アイテムを一覧表示
- **投稿作成画面**: 新しい投稿（経験談または出品）を作成
- **出品編集画面**: 自分の出品アイテムを編集・削除
- **プロフィール画面**: ユーザー情報と自分の投稿・出品を管理
- **ログイン/新規登録画面**: ユーザー認証

#### 4.1.2 状態管理
- **AuthContext**: 認証状態の管理
- **LanguageContext**: 言語設定の管理（現在は日本語のみ）
- **PostContext**: 投稿データの管理

#### 4.1.3 ルーティング
- React Router の HashRouter を使用（GitHub Pages 対応）
- 保護されたルート（認証が必要なページ）

### 4.2 バックエンド実装

#### 4.2.1 API エンドポイント
- **認証**: `POST /api/auth/register`, `POST /api/auth/login`
- **投稿**: `GET /api/posts`, `POST /api/posts`, `GET /api/posts/{id}`, `DELETE /api/posts/{id}`
- **出品**: `GET /api/items`, `POST /api/items`, `GET /api/items/{id}`, `PUT /api/items/{id}`, `DELETE /api/items/{id}`
- **いいね**: `POST /api/posts/{id}/like`, `POST /api/items/{id}/like`

#### 4.2.2 セキュリティ
- JWT トークンベースの認証
- パスワードの Argon2 ハッシュ化
- CORS 設定
- レート制限（Redis を使用）

#### 4.2.3 データベース
- SQLAlchemy ORM によるデータアクセス
- トランザクション管理
- 外部キー制約と CASCADE 削除

### 4.3 デプロイメント

#### 4.3.1 フロントエンド
- GitHub Pages に静的ホスティング
- GitHub Actions による自動ビルド・デプロイ
- HashRouter による SPA ルーティング対応

#### 4.3.2 バックエンド
- Docker Compose によるローカル開発環境
- PostgreSQL、MinIO、Redis を含むマルチコンテナ構成

## 5. 課題と解決策

### 5.1 課題 1: GitHub Pages でのルーティング問題

#### 問題
GitHub Pages は静的ホスティングのため、`BrowserRouter` を使用すると、直接 URL にアクセスした際に 404 エラーが発生する。

#### 解決策
- `HashRouter` に変更することで、クライアントサイドルーティングを実現
- `vite.config.js` の `base` パスを `/Database_Final/` に設定

### 5.2 課題 2: 出品アイテムの編集・削除機能の実装

#### 問題
初期実装では、出品アイテムの編集・削除機能が実装されていなかった。

#### 解決策
- バックエンドに `PUT /api/items/{id}` エンドポイントを追加
- `ItemUpdate` スキーマを定義
- フロントエンドに `EditItemPage` を実装
- `PostContext` に `refreshItems` 関数を追加して、編集・削除後の一覧を更新

### 5.3 課題 3: 価格入力の制限

#### 問題
価格入力フィールドに `step="100"` が設定されており、100 円単位でのみ入力可能だった。

#### 解決策
- `CreatePost.jsx` と `EditItemPage.jsx` の価格入力フィールドの `step` 属性を `"1"` に変更
- 任意の整数価格を入力可能に

### 5.4 課題 4: バックエンドが利用できない場合のフロントエンド表示

#### 問題
GitHub Pages にデプロイされたフロントエンドは、バックエンドが利用できない場合、データを表示できない。

#### 解決策
- `mockData.js` を作成し、モックデータを提供
- `PostContext.jsx` で API 呼び出しが失敗した場合、モックデータにフォールバック
- フロントエンドのみでも UI/UX を確認できるように

### 5.5 課題 5: 翻訳機能の削除

#### 問題
初期実装では、多言語対応（日本語、英語、中国語）が実装されていたが、要件変更により日本語のみに統一する必要があった。

#### 解決策
- `LanguageContext.jsx` から英語・中国語の言語ファイルを削除
- 言語切り替え UI を削除
- すべての UI テキストを日本語に統一

## 6. まとめと今後の展望

### 6.1 まとめ
本プロジェクトでは、大学生向けキャンパスライフ支援プラットフォーム「MemoLucky」を開発しました。経験談の共有、フリマ機能、研究室情報、就活情報などの機能を実装し、GitHub Pages にデプロイしました。React と FastAPI を使用したモダンな Web アプリケーションとして、基本的な CRUD 機能を実現しました。

### 6.2 今後の展望

#### 6.2.1 機能拡張
- **リアルタイムチャット**: WebSocket によるメッセージング機能
- **通知システム**: いいね、コメント、メッセージの通知
- **フォロー機能**: ユーザー間のフォロー関係
- **コメント機能**: 投稿へのコメント機能
- **バッジシステム**: 活動に応じたバッジ獲得機能

#### 6.2.2 技術的改善
- **CDN**: 静的ファイルの高速配信
- **データベースレプリケーション**: 読み取り負荷分散
- **キャッシュ強化**: Redis による頻繁にアクセスされるデータのキャッシュ
- **画像最適化**: 自動リサイズ・WebP 変換
- **モバイルアプリ**: React Native による iOS/Android アプリ

#### 6.2.3 運用改善
- **監視システム**: Prometheus + Grafana によるメトリクス監視
- **ログ集約**: ELK Stack によるログ分析
- **自動バックアップ**: 定期的なデータベース・オブジェクトストレージのバックアップ
- **災害復旧**: 自動フェイルオーバーと復旧手順の自動化

### 6.3 学んだこと
- **フロントエンドとバックエンドの分離**: モダンな Web アプリケーション開発のベストプラクティス
- **RESTful API 設計**: 適切な HTTP メソッドとステータスコードの使用
- **認証・認可**: JWT トークンベースの認証の実装
- **デプロイメント**: GitHub Pages と GitHub Actions による CI/CD
- **データベース設計**: 正規化、インデックス、外部キー制約の重要性

### 6.4 反省点
- **要件定義の段階での詳細化**: 初期段階でより詳細な要件定義を行うべきだった
- **テストの不足**: ユニットテスト、統合テストの実装が不足していた
- **ドキュメント整備**: 開発と並行してドキュメントを整備すべきだった
- **パフォーマンステスト**: 負荷テストやパフォーマンステストの実施が不足していた

## 7. 参考文献・リソース

- FastAPI 公式ドキュメント: https://fastapi.tiangolo.com/
- React 公式ドキュメント: https://react.dev/
- PostgreSQL 公式ドキュメント: https://www.postgresql.org/docs/
- GitHub Pages 公式ドキュメント: https://docs.github.com/ja/pages
- Docker 公式ドキュメント: https://docs.docker.com/

## 8. 付録

### 8.1 プロジェクト構成
```
memolucky/
├── frontend/          # フロントエンド（React + Vite）
├── backend/          # バックエンド（FastAPI）
├── docs/             # ドキュメント
│   ├── BA/          # Business Analyst 関連
│   ├── Architect/   # アーキテクト関連
│   ├── DBA/         # DBA 関連
│   └── PM/          # プロジェクトマネージャー関連
├── docker-compose.yml # Docker Compose 設定
└── README.md         # プロジェクト概要
```

### 8.2 主要ファイル
- `frontend/src/App.jsx`: メインアプリケーションコンポーネント
- `frontend/src/contexts/PostContext.jsx`: 投稿データの状態管理
- `backend/app/main.py`: FastAPI アプリケーションのエントリーポイント
- `backend/app/posts.py`: 投稿関連の API エンドポイント
- `backend/app/items.py`: 出品関連の API エンドポイント

### 8.3 デプロイ先
- **フロントエンド**: https://syokan00.github.io/Database_Final/
- **GitHub リポジトリ**: https://github.com/syokan00/Database_Final


